<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>JPP: Stories from Bagram</title>
	<meta name="author" content="Michael Wolf" />
  <meta name="description" content="Justice Project Pakistan Bagram Companion Visualization" />
	<meta name="Resource-type" content="Document" />

  
  <link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/main.css" />
  
</head>
<body>

  <!-- MG start -->
  <link href='css/metricsgraphics.css' rel='stylesheet' type='text/css'>

  <script src='lib/MG/js/MG.js'></script>
  <script src='lib/MG/js/misc/utility.js'></script>
  <script src='lib/MG/js/common/data_graphic.js'></script>
  <script src='lib/MG/js/common/hooks.js'></script>
  <script src='lib/MG/js/common/register.js'></script>
  <!--
  <script src='lib/MG/js/common/bootstrap_tooltip_popover.js'></script>
  -->
  <script src='lib/MG/js/common/scales.js'></script>
  <script src='lib/MG/js/common/chart_title.js'></script>
  <script src='lib/MG/js/common/y_axis.js'></script>
  <script src='lib/MG/js/common/x_axis.js'></script>
  <script src='lib/MG/js/common/scales.js'></script>
  <script src='lib/MG/js/common/init.js'></script>
  <script src='lib/MG/js/common/markers.js'></script>
  <script src='lib/MG/js/common/rollover.js'></script>
  <!--
  <script src='lib/MG/js/common/zoom.js'></script>
  <script src='lib/MG/js/common/brush.js'></script>
  -->
  <script src='lib/MG/js/common/window_listeners.js'></script>
  <!--
  <script src='lib/MG/js/layout/bootstrap_dropdown.js'></script>
  <script src='lib/MG/js/layout/button.js'></script>
  -->
  <script src='lib/MG/js/charts/line.js'></script>
  <script src='lib/MG/js/charts/histogram.js'></script>
  <script src='lib/MG/js/charts/point.js'></script>
  <script src='lib/MG/js/charts/bar.js'></script>
  <script src='lib/MG/js/charts/table.js'></script>
  <script src='lib/MG/js/charts/missing.js'></script>
  <script src='lib/MG/js/misc/process.js'></script>
  <script src='lib/MG/js/misc/smoothers.js'></script>
  <script src='lib/MG/js/misc/formatters.js'></script>
  <script src='lib/MG/js/misc/transitions.js'></script>
  <script src='lib/MG/js/misc/error.js'></script>
  <!-- MG end -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>

<!--
  <script src="https://d3js.org/d3-format.v1.min.js"></script>
  <script src="https://unpkg.com/d3-array@1"></script>
-->
  <script src="https://unpkg.com/d3-collection@1"></script>
  <script src="https://unpkg.com/d3-path@1"></script>
  <script src="https://unpkg.com/d3-shape@1"></script>
  <script src="https://unpkg.com/d3-sankey@0"></script>
  
  <script src="https://d3js.org/d3-array.v2.min.js"></script>
  <script src="https://d3js.org/d3-color.v1.min.js"></script>
  <script src="https://d3js.org/d3-format.v1.min.js"></script>
  <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
  <script src="https://d3js.org/d3-time.v1.min.js"></script>
  <script src="https://d3js.org/d3-time-format.v2.min.js"></script>
  <script src="https://d3js.org/d3-scale.v3.min.js"></script>
  
  <script>
    width = 975
    height = 600
    rShift = 40

    // $('path').each( function(i,e,t){ setTimeout ((t) => {$(t).css('opacity', "") }, i*.2 * 1000, this) } );
    // https://paradite.com/2016/04/30/d3-js-chained-transitions/
    // https://github.com/d3/d3-transition delay()

    sankey = function() {
      const sankey = d3.sankey()
          //.nodeAlign(d3[`sankey${align[0].toUpperCase()}${align.slice(1)}`])
          .nodeWidth(1)
          .nodePadding(20)
          .extent([[1, 5], [width - (rShift * 2) - 1, height - 5]]);
      sankey.nodeId(d => d.name); // accessor
      
      return ({nodes, links}) => sankey({
        nodes: nodes.map(d => Object.assign({}, d)),
        links: links.map(d => Object.assign({}, d))
      });
    }()
    
    format = function() {
      const f = d3.format(",.0f");
      return d => `${f(d)} TWh`;
    }()
    
    color = function() {
      const color = d3.scaleOrdinal(d3.schemeSet3);
      return name => color(name.replace(/ .*/, ""));
    }()
    
  </script>
  
  <svg></svg>
  



  
  <script src="js/data.js"></script>
  <script src="js/sankey.js"></script>
  <script src="js/main.js"></script>
    
</body>
</html>
